<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////home/nick/matlab/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for blockproc</title><link rel="stylesheet" href="file:////home/nick/matlab/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">blockproc (1 call, 3657.534 sec)</span><br/><i>Generated 12-Jun-2013 14:59:18 using cpu time.</i><br/>M-function in file /home/nick/matlab/toolbox/images/images/blockproc.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/> No parent <div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line330">330</a></td><td class="td-linebottomrt"><pre>output_block = userfunDispatch...</pre></td><td class="td-linebottomrt">40061</td><td class="td-linebottomrt">2798.024 s</td><td class="td-linebottomrt" class="td-linebottomrt">76.5%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=77 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line329">329</a></td><td class="td-linebottomrt"><pre>input_struct = getBlock(a,asiz...</pre></td><td class="td-linebottomrt">40061</td><td class="td-linebottomrt">819.365 s</td><td class="td-linebottomrt" class="td-linebottomrt">22.4%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=22 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line368">368</a></td><td class="td-linebottomrt"><pre>wait_bar.update();</pre></td><td class="td-linebottomrt">40060</td><td class="td-linebottomrt">28.274 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.8%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line331">331</a></td><td class="td-linebottomrt"><pre>putBlock(b,bsize,output_size,r...</pre></td><td class="td-linebottomrt">40061</td><td class="td-linebottomrt">7.142 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line334">334</a></td><td class="td-linebottomrt"><pre>elapsed_time = now - start_tim...</pre></td><td class="td-linebottomrt">40061</td><td class="td-linebottomrt">2.289 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">2.441 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">3657.534 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file70.html">blockproc>userfunDispatcher</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">40062</td><td class="td-linebottomrt">2797.938 s</td><td class="td-linebottomrt">76.5%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=76 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file44.html">blockproc>getBlock</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">40062</td><td class="td-linebottomrt">819.251 s</td><td class="td-linebottomrt">22.4%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=22 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file79.html">...ableWaitbar>cancellableWaitbar.update</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">40060</td><td class="td-linebottomrt">27.647 s</td><td class="td-linebottomrt">0.8%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file73.html">blockproc>putBlock</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">40062</td><td class="td-linebottomrt">6.886 s</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file76.html">now</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">40062</td><td class="td-linebottomrt">2.099 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file108.html">...aitbar>cancellableWaitbar.isCancelled</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">40060</td><td class="td-linebottomrt">0.855 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file25.html">blockproc>getOutputContainer</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.104 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file78.html">...cancellableWaitbar.cancellableWaitbar</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.057 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file40.html">...spatcher>AdapterDispatcher.readRegion</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.019 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file4.html">blockproc>createInputAdapter</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file5.html">blockproc>parse_inputs</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file86.html">onCleanup>onCleanup.delete</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file82.html">usejava</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file75.html">meshgrid</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file74.html">blockproc>create@()b.close()</a></td><td class="td-linebottomrt">M-anonymous-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file30.html">...tcher>AdapterDispatcher.get.ImageSize</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file29.html">onCleanup>onCleanup.onCleanup</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file27.html">blockproc>create@()a.close()</a></td><td class="td-linebottomrt">M-anonymous-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file26.html">...r>AdapterDispatcher.AdapterDispatcher</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">2.659 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////home/nick/matlab/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">3657.534 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/>No M-Lint messages.<div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">385</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">257</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">128</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">94</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">34</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">73.44 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function result_image = blockproc(varargin)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%BLOCKPROC Distinct block processing for image.</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%   B = BLOCKPROC(A,[M N],FUN) processes the image A by applying the</span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   function FUN to each distinct M-by-N block of A and concatenating the</span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%   results into the output matrix B.  FUN is a function handle to a</span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%   function that accepts a "block struct" as input and returns a matrix,</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%   vector, or scalar Y:</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%       Y = FUN(BLOCK_STRUCT)</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%   For each block of data in the input image, A, BLOCKPROC will pass the</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%   block in a "block struct" to the user function, FUN, to produce Y, the</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%   corresponding block in the output image.  If Y is empty, then no output</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%   is generated and BLOCKPROC returns empty after processing all blocks.</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">%   A "block struct" is a MATLAB structure that contains the block data as</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%   well as other information about the block.  Fields in the block struct</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%   are:</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%       BLOCK_STRUCT.border : a 2-element vector, [V H], that specifies the</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%                             size of the vertical and horizontal padding</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%                             around the block of data (see 'BorderSize'</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%                             argument below).</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%       BLOCK_STRUCT.blockSize : a 2-element vector, [rows cols],</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%                                specifying the size of the block data. If</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%                                a border has been specified, the size does</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%                                not include the border pixels.</span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%       BLOCK_STRUCT.data : M-by-N or M-by-N-by-P matrix of block data plus</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%                           any included border pixels.</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%       BLOCK_STRUCT.imageSize : a 2-element vector, [rows cols],</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%                                specifying the full size of the input</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%                                image.</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%       BLOCK_STRUCT.location : a 2-element vector, [row col], that</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%                               specifies the position of the first pixel </span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%                               (minimum-row, minimum-column) of the block</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%                               data in the input image.  If a border has</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%                               been specified, the location refers to the</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%                               first pixel of the discrete block data, not</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%                               the added border pixels.</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%   B = BLOCKPROC(SRC_FILENAME,[M N],FUN) processes the image specified by</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%   SRC_FILENAME, reading and processing one block at a time.  This syntax</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%   is useful for processing very large images since only one block of the</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%   image is read into memory at a time.  If the output matrix B is too</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%   large to fit into memory, then you should additionally use the</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%   'Destination' parameter/value pair to write the output to a file.  See</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%   below for information on supported file types and parameters.</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%   B = BLOCKPROC(ADAPTER,[M N],FUN) processes the source image specified</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%   by ADAPTER, an ImageAdapter object.  ImageAdapters are user-defined</span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%   classes that provide BLOCKPROC with a common API for reading and</span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%   writing to a particular image file format.  See the documentation for</span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%   ImageAdapter for more details.</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%   BLOCKPROC(...,PARAM1,VAL1,PARAM2,VAL2,...) processes the input image,</span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">%   specifying parameters and corresponding values that control various</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">%   aspects of the block behavior.  Parameter name case does not matter.</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">%   Parameters include:</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">%   'Destination'       The destination for the output of BLOCKPROC.  When</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">%                       specified, BLOCKPROC will not return the processed</span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">%                       image as an output argument, but instead write the</span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;">%                       output to the 'Destination'.  Valid 'Destination'</span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">%                       parameters are:</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;">%                          TIFF filename: a string filename ending with</span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;">%                             '.tif'.  This file will be overwritten if it</span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;">%                             exists.</span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;">%                          ImageAdapter object: an instance of an</span><br/>               <span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF;">%                             ImageAdapter class.  ImageAdapters provide an</span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;">%                             interface for reading and writing to</span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;">%                             arbitrary image file formats.  See the</span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">%                             documentation for ImageAdapter for more</span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">%                             information.</span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF;">%                       The 'Destination' parameter is useful when you</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF;">%                       expect your output to be too large to practically</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #228B22; background: #FFFFFF;">%                       fit into memory.  It provides a workflow for</span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #228B22; background: #FFFFFF;">%                       file-to-file image processing for arbitrarily large</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF;">%                       images.</span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;">%   'BorderSize'        A 2-element vector, [V H], specifying the amount of</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #228B22; background: #FFFFFF;">%                       border pixels to add to each block.  V rows are</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF;">%                       added above and below each block, H columns are</span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #228B22; background: #FFFFFF;">%                       added left and right of each block.  The size of</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;">%                       each resulting block will be:</span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;">%                           [M + 2*V, N + 2*H]</span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">%                       The default is [0 0], meaning no border.</span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #228B22; background: #FFFFFF;">%                       By default, the border is automatically removed</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;">%                       from the result of FUN.  See the 'TrimBorder'</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;">%                       parameter for more information.</span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF;">%                       Blocks with borders that extend beyond the edges of</span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;">%                       the image are padded with zeros.</span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF;">%   'TrimBorder'        A logical scalar.  When set to true, BLOCKPROC</span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;">%                       trims off border pixels from the output of the user</span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;">%                       function, FUN.  V rows are removed from the top and</span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF;">%                       bottom of the output of FUN, and H columns are</span><br/>               <span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF;">%                       removed from the left and right edges, where V and</span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;">%                       H are defined by the 'BorderSize' parameter.  The</span><br/>               <span style="color: #A0A0A0"> 109</span> <span style="color: #228B22; background: #FFFFFF;">%                       default is true, meaning borders are automatically</span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;">%                       removed from the output of FUN.</span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF;">%   'PadPartialBlocks'  A logical scalar.  When set to true, BLOCKPROC will</span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF;">%                       pad partial blocks to make them full-sized (M-by-N)</span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #228B22; background: #FFFFFF;">%                       blocks.  Partial blocks arise when the image size</span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF;">%                       is not exactly divisible by the block size.  If</span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF;">%                       they exist, partial blocks will lie along the right</span><br/>               <span style="color: #A0A0A0"> 117</span> <span style="color: #228B22; background: #FFFFFF;">%                       and bottom edge of the image.  The default is</span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF;">%                       false, meaning the partial blocks are not padded,</span><br/>               <span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;">%                       but processed as-is.</span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;">%                       BLOCKPROC uses zeros to pad partial blocks when</span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;">%                       necessary.</span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;">%   File Format Support</span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF;">%   -------------------</span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #228B22; background: #FFFFFF;">%   Input and output files for BLOCKPROC (as specified by SRC_FILENAME</span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #228B22; background: #FFFFFF;">%   and/or the 'Destination' parameter) must be of the following file types</span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #228B22; background: #FFFFFF;">%   and must be named with one of the listed file extensions:</span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #228B22; background: #FFFFFF;">%       Read / Write File Formats</span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #228B22; background: #FFFFFF;">%       -------------------------</span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #228B22; background: #FFFFFF;">%       TIFF: *.tif, *.tiff</span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;">%       Read-Only File Formats</span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #228B22; background: #FFFFFF;">%       ----------------------</span><br/>               <span style="color: #A0A0A0"> 136</span> <span style="color: #228B22; background: #FFFFFF;">%       JPEG2000: *.jp2, *.jpf, *.jpx, *.j2c, *.j2k</span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #228B22; background: #FFFFFF;">%   See the reference page for BLOCKPROC for additional file format</span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #228B22; background: #FFFFFF;">%   specific limitations.</span><br/>               <span style="color: #A0A0A0"> 140</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 141</span> <span style="color: #228B22; background: #FFFFFF;">%   Block Sizes</span><br/>               <span style="color: #A0A0A0"> 142</span> <span style="color: #228B22; background: #FFFFFF;">%   -----------</span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #228B22; background: #FFFFFF;">%   When using BLOCKPROC to either read or write image files, file access</span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #228B22; background: #FFFFFF;">%   can be an important factor in performance.  In general, selecting</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #228B22; background: #FFFFFF;">%   larger block sizes will reduce the number of times BLOCKPROC will have</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;">%   to access the disk, at the cost of using more memory to process each</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #228B22; background: #FFFFFF;">%   block.  Knowledge of the file format layout on disk can also be useful</span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #228B22; background: #FFFFFF;">%   in selecting block sizes that minimize the number of times the disk is</span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;">%   accessed.</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 151</span> <span style="color: #228B22; background: #FFFFFF;">%   Examples</span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #228B22; background: #FFFFFF;">%   --------</span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #228B22; background: #FFFFFF;">%   This simple example uses the IMRESIZE function to generate an image</span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #228B22; background: #FFFFFF;">%   thumbnail.</span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 156</span> <span style="color: #228B22; background: #FFFFFF;">%       fun = @(block_struct) imresize(block_struct.data,0.15);</span><br/>               <span style="color: #A0A0A0"> 157</span> <span style="color: #228B22; background: #FFFFFF;">%       I = imread('pears.png');</span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #228B22; background: #FFFFFF;">%       I2 = blockproc(I,[100 100],fun);</span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #228B22; background: #FFFFFF;">%       figure;</span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #228B22; background: #FFFFFF;">%       imshow(I);</span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #228B22; background: #FFFFFF;">%       figure;</span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #228B22; background: #FFFFFF;">%       imshow(I2);</span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 164</span> <span style="color: #228B22; background: #FFFFFF;">%   This example uses BLOCKPROC to set the pixels in each 32-by-32 block</span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #228B22; background: #FFFFFF;">%   to the standard deviation of the elements in that block.</span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #228B22; background: #FFFFFF;">%       fun = @(block_struct) std2(block_struct.data) * ones(size(block_struct.data));</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #228B22; background: #FFFFFF;">%       I2 = blockproc('moon.tif',[32 32],fun);</span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;">%       figure;</span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #228B22; background: #FFFFFF;">%       imshow('moon.tif');</span><br/>               <span style="color: #A0A0A0"> 171</span> <span style="color: #228B22; background: #FFFFFF;">%       figure;</span><br/>               <span style="color: #A0A0A0"> 172</span> <span style="color: #228B22; background: #FFFFFF;">%       imshow(I2,[]);</span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 174</span> <span style="color: #228B22; background: #FFFFFF;">%   This example uses BLOCKPROC to switch the red and green bands of an RGB</span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #228B22; background: #FFFFFF;">%   image and writes the results to a new TIFF file.</span><br/>               <span style="color: #A0A0A0"> 176</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 177</span> <span style="color: #228B22; background: #FFFFFF;">%       I = imread('peppers.png');</span><br/>               <span style="color: #A0A0A0"> 178</span> <span style="color: #228B22; background: #FFFFFF;">%       fun = @(block_struct) block_struct.data(:,:,[2 1 3]);</span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #228B22; background: #FFFFFF;">%       blockproc(I,[200 200],fun,'Destination','grb_peppers.tif');</span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #228B22; background: #FFFFFF;">%       figure;</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #228B22; background: #FFFFFF;">%       imshow('peppers.png');</span><br/>               <span style="color: #A0A0A0"> 182</span> <span style="color: #228B22; background: #FFFFFF;">%       figure;</span><br/>               <span style="color: #A0A0A0"> 183</span> <span style="color: #228B22; background: #FFFFFF;">%       imshow('grb_peppers.tif');</span><br/>               <span style="color: #A0A0A0"> 184</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #228B22; background: #FFFFFF;">%   See also COLFILT, FUNCTION_HANDLE, IMAGEADAPTER, NLFILTER.</span><br/>               <span style="color: #A0A0A0"> 186</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright 2008-2009 The MathWorks, Inc.</span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #228B22; background: #FFFFFF;">%   $Revision: 1.1.6.5 $  $Date: 2009/10/16 04:57:19 $</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #228B22; background: #FFFFFF;">% parse input arguments</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 191</span> <span style="color: #000000; background: #FFFFFF;">parsed_args = <a href="file5.html">parse_inputs</a>(varargin{:}); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 192</span> <span style="color: #000000; background: #FFFFFF;">a = parsed_args.Input; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 193</span> <span style="color: #000000; background: #FFFFFF;">b = parsed_args.Destination; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 194</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(b) </span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #A0A0A0; background: #FFFFFF;">    destination_specified = true;</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if isa(b,'char')</span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #A0A0A0; background: #FFFFFF;">        dest_file_name = parsed_args.Destination;</span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #A0A0A0; background: #FFFFFF;">        dest_file_name = [];</span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 201</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 202</span> <span style="color: #000000; background: #FFFFFF;">    destination_specified = false; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 203</span> <span style="color: #000000; background: #FFFFFF;">    dest_file_name = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 204</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 205</span> <span style="color: #000000; background: #FFFFFF;">block = floor(parsed_args.BlockSize); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #000000; background: #FFFFFF;">border = floor(parsed_args.BorderSize); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 207</span> <span style="color: #000000; background: #FFFFFF;">fun = parsed_args.Function; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 208</span> <span style="color: #000000; background: #FFFFFF;">pad_partial_blocks = parsed_args.PadPartialBlocks; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 209</span> <span style="color: #000000; background: #FFFFFF;">trim_border = parsed_args.TrimBorder; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 210</span> <span style="color: #000000; background: #FFFFFF;">pad_value = 0; </span><br/>               <span style="color: #A0A0A0"> 211</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 212</span> <span style="color: #228B22; background: #FFFFFF;">% check for incompatible parameters</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 213</span> <span style="color: #000000; background: #FFFFFF;">if destination_specified &amp;&amp; nargout &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 214</span> <span style="color: #A0A0A0; background: #FFFFFF;">    eid = sprintf('Images:%s:tooManyOutputArguments',mfilename);</span><br/>               <span style="color: #A0A0A0"> 215</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(eid,'%s%s%s','Too many output arguments.  When the ',...</span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #A0A0A0; background: #FFFFFF;">        '''Destination'' parameter is specified, BLOCKPROC does not ',...</span><br/>               <span style="color: #A0A0A0"> 217</span> <span style="color: #A0A0A0; background: #FFFFFF;">        'return any output.');</span><br/>               <span style="color: #A0A0A0"> 218</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 220</span> <span style="color: #228B22; background: #FFFFFF;">% create dispatchers for source adapter and set up clean up routine</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 221</span> <span style="color: #000000; background: #FFFFFF;">if isa(a,'ImageAdapter') </span><br/>               <span style="color: #A0A0A0"> 222</span> <span style="color: #A0A0A0; background: #FFFFFF;">    a = internal.images.AdapterDispatcher(a,'r');</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 223</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 224</span> <span style="color: #000000; background: #FFFFFF;">    a = <a href="file4.html">createInputAdapter</a>(a); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 225</span> <span style="color: #000000; background: #FFFFFF;">    a = internal.images.AdapterDispatcher(a,'r'); </span><br/>               <span style="color: #A0A0A0"> 226</span> <span style="color: #228B22; background: #FFFFFF;">    % we must close any adapters that we create</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 227</span> <span style="color: #000000; background: #FFFFFF;">    cleanup_a = onCleanup(@() a.close()); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 228</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 230</span> <span style="color: #228B22; background: #FFFFFF;">% compute size of required padding along image edges</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 231</span> <span style="color: #000000; background: #FFFFFF;">asize = a.ImageSize; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 232</span> <span style="color: #000000; background: #FFFFFF;">ma = asize(1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 233</span> <span style="color: #000000; background: #FFFFFF;">na = asize(2); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 234</span> <span style="color: #000000; background: #FFFFFF;">mpad = rem(ma,block(1)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 235</span> <span style="color: #000000; background: #FFFFFF;">if mpad &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 236</span> <span style="color: #000000; background: #FFFFFF;">    mpad = block(1) - mpad; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 237</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 238</span> <span style="color: #000000; background: #FFFFFF;">npad = rem(na,block(2)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 239</span> <span style="color: #000000; background: #FFFFFF;">if npad &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 240</span> <span style="color: #000000; background: #FFFFFF;">    npad = block(2) - npad; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 241</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 243</span> <span style="color: #228B22; background: #FFFFFF;">% number of blocks we'll process</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 244</span> <span style="color: #000000; background: #FFFFFF;">mblocks = (ma + mpad) / block(1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 245</span> <span style="color: #000000; background: #FFFFFF;">nblocks = (na + npad) / block(2); </span><br/>               <span style="color: #A0A0A0"> 246</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #228B22; background: #FFFFFF;">% get first block and process it</span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 248</span> <span style="color: #000000; background: #FFFFFF;">input_struct = <a href="file44.html">getBlock</a>(a,asize,block,border,1,1,pad_value,pad_partial_blocks); </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 249</span> <span style="color: #000000; background: #FFFFFF;">[output_block has_output] = <a href="file70.html">userfunDispatcher</a>(fun,input_struct,trim_border,false); </span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 251</span> <span style="color: #228B22; background: #FFFFFF;">% verify user FUN returned something valid</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 252</span> <span style="color: #000000; background: #FFFFFF;">if ~(isempty(output_block) || isnumeric(output_block) || islogical(output_block)) </span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #A0A0A0; background: #FFFFFF;">    eid = sprintf('Images:%s:invalidOutputClass',mfilename);</span><br/>               <span style="color: #A0A0A0"> 254</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(eid,'%s%s%s%s','Invalid output class.  The user function, ',...</span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #A0A0A0; background: #FFFFFF;">        'FUN, returned an invalid result.  The class of the result was ',...</span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #A0A0A0; background: #FFFFFF;">        class(output_block), '.');</span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF;">% if we are writing to a file, verify we have data to write</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 260</span> <span style="color: #000000; background: #FFFFFF;">if destination_specified &amp;&amp; isempty(output_block) </span><br/>               <span style="color: #A0A0A0"> 261</span> <span style="color: #A0A0A0; background: #FFFFFF;">    eid = sprintf('Images:%s:emptyFile',mfilename);</span><br/>               <span style="color: #A0A0A0"> 262</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(eid,'%s%s%s','Cannot write empty file.  The user function, ',...</span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #A0A0A0; background: #FFFFFF;">        'FUN, cannot return empty when the ''Destination'' parameter ',...</span><br/>               <span style="color: #A0A0A0"> 264</span> <span style="color: #A0A0A0; background: #FFFFFF;">        'has been specified.');</span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF;">% get output block size</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 268</span> <span style="color: #000000; background: #FFFFFF;">output_size  = size(output_block); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 269</span> <span style="color: #000000; background: #FFFFFF;">output_size  = output_size(1:2); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 270</span> <span style="color: #000000; background: #FFFFFF;">output_bands = size(output_block,3); </span><br/>               <span style="color: #A0A0A0"> 271</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 272</span> <span style="color: #000000; background: #FFFFFF;">if destination_specified &amp;&amp; isa(b,'ImageAdapter') </span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF;">    % b is an ImageAdapter, we just wrap it with the dispatcher</span><br/>               <span style="color: #A0A0A0"> 274</span> <span style="color: #A0A0A0; background: #FFFFFF;">    rows_probed = false;</span><br/>               <span style="color: #A0A0A0"> 275</span> <span style="color: #A0A0A0; background: #FFFFFF;">    cols_probed = false;</span><br/>               <span style="color: #A0A0A0"> 276</span> <span style="color: #A0A0A0; background: #FFFFFF;">    b = internal.images.AdapterDispatcher(b,'r+');</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 277</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">    % we need to create the output adapter</span><br/><span style="color: #FF0000">  0.10 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 279</span> <span style="color: #000000; background: #FFFFFF;">    [b,rows_probed,cols_probed] = <a href="file25.html">getOutputContainer</a>(a,asize,b,fun,block,... </span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #000000; background: #FFFFFF;">        trim_border,mblocks,nblocks,mpad,npad,pad_value,pad_partial_blocks,...</span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #000000; background: #FFFFFF;">        output_size,output_bands,class(output_block),border,has_output);</span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #228B22; background: #FFFFFF;">    % cleanup b if necessary</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 283</span> <span style="color: #000000; background: #FFFFFF;">    cleanup_b = onCleanup(@() b.close()); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 284</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 285</span> <span style="color: #000000; background: #FFFFFF;">bsize = b.ImageSize; </span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 287</span> <span style="color: #228B22; background: #FFFFFF;">% copy the first block into the upper-left of the output matrix</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 288</span> <span style="color: #000000; background: #FFFFFF;"><a href="file73.html">putBlock</a>(b,bsize,output_size,1,1,output_block); </span><br/>               <span style="color: #A0A0A0"> 289</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #228B22; background: #FFFFFF;">% get row/column indices of all unprocessed blocks</span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #228B22; background: #FFFFFF;">% start with interior blocks (unprobed rows/cols)</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 292</span> <span style="color: #000000; background: #FFFFFF;">[r,c] = <a href="file75.html">meshgrid</a>(2:mblocks,2:nblocks); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 293</span> <span style="color: #000000; background: #FFFFFF;">rr = r(:); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 294</span> <span style="color: #000000; background: #FFFFFF;">cc = c(:); </span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 296</span> <span style="color: #000000; background: #FFFFFF;">previously_processed = 1; </span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #228B22; background: #FFFFFF;">% add unprocessed blocks from first row</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 299</span> <span style="color: #000000; background: #FFFFFF;">if cols_probed </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 300</span> <span style="color: #000000; background: #FFFFFF;">    end_col = nblocks - 1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 301</span> <span style="color: #000000; background: #FFFFFF;">    previously_processed = previously_processed + 1; </span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end_col = nblocks;</span><br/>               <span style="color: #A0A0A0"> 304</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 305</span> <span style="color: #000000; background: #FFFFFF;">[r,c] = <a href="file75.html">meshgrid</a>(1,2:end_col); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 306</span> <span style="color: #000000; background: #FFFFFF;">rr = [rr;r(:)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 307</span> <span style="color: #000000; background: #FFFFFF;">cc = [cc;c(:)]; </span><br/>               <span style="color: #A0A0A0"> 308</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 309</span> <span style="color: #228B22; background: #FFFFFF;">% add unprocessed blocks from first column</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 310</span> <span style="color: #000000; background: #FFFFFF;">if rows_probed </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 311</span> <span style="color: #000000; background: #FFFFFF;">    end_row = mblocks - 1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 312</span> <span style="color: #000000; background: #FFFFFF;">    previously_processed = previously_processed + 1; </span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end_row = mblocks;</span><br/>               <span style="color: #A0A0A0"> 315</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 316</span> <span style="color: #000000; background: #FFFFFF;">[r,c] = <a href="file75.html">meshgrid</a>(2:end_row,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 317</span> <span style="color: #000000; background: #FFFFFF;">rr = [rr;r(:)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 318</span> <span style="color: #000000; background: #FFFFFF;">cc = [cc;c(:)]; </span><br/>               <span style="color: #A0A0A0"> 319</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 320</span> <span style="color: #228B22; background: #FFFFFF;">% get number of remaining blocks</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 321</span> <span style="color: #000000; background: #FFFFFF;">num_blocks = length(rr); </span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 323</span> <span style="color: #228B22; background: #FFFFFF;">% for each remaining block</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 324</span> <span style="color: #000000; background: #FFFFFF;">start_time = <a href="file76.html">now</a>; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 325</span> <span style="color: #000000; background: #FFFFFF;">wait_bar = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 326</span> <span style="color: #000000; background: #FFFFFF;">for k = 1:num_blocks </span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 328</span> <span style="color: #228B22; background: #FFFFFF;">    % read/process/write the block</span><br/><span style="color: #FF0000"> 819.36 </span><span style="color: #0000FF">  40061 </span><span style="color: #000000; font-weight: bold"> 329</span> <a name="Line329"></a><span style="color: #000000; background: #FFE2E2;">    input_struct = <a href="file44.html">getBlock</a>(a,asize,block,border,rr(k),cc(k),pad_value,pad_partial_blocks); </span><br/><span style="color: #FF0000"> 2798.02 </span><span style="color: #0000FF">  40061 </span><span style="color: #000000; font-weight: bold"> 330</span> <a name="Line330"></a><span style="color: #000000; background: #FF8080;">    output_block = <a href="file70.html">userfunDispatcher</a>(fun,input_struct,trim_border,true,has_output); </span><br/><span style="color: #FF0000">  7.14 </span><span style="color: #0000FF">  40061 </span><span style="color: #000000; font-weight: bold"> 331</span> <a name="Line331"></a><span style="color: #000000; background: #FFFFFF;">    <a href="file73.html">putBlock</a>(b,bsize,output_size,rr(k),cc(k),output_block); </span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #228B22; background: #FFFFFF;">    % keep a running total of how long we've taken</span><br/><span style="color: #FF0000">  2.29 </span><span style="color: #0000FF">  40061 </span><span style="color: #000000; font-weight: bold"> 334</span> <a name="Line334"></a><span style="color: #000000; background: #FFFFFF;">    elapsed_time = <a href="file76.html">now</a> - start_time; </span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/><span style="color: #FF0000">  0.18 </span><span style="color: #0000FF">  40061 </span><span style="color: #000000; font-weight: bold"> 336</span> <span style="color: #000000; background: #FFFFFF;">    if isempty(wait_bar) </span><br/>               <span style="color: #A0A0A0"> 337</span> <span style="color: #228B22; background: #FFFFFF;">        % decide if we need a wait bar</span><br/>               <span style="color: #A0A0A0"> 338</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 339</span> <span style="color: #000000; background: #FFFFFF;">        remaining_time = elapsed_time / k * (num_blocks - k); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 340</span> <span style="color: #000000; background: #FFFFFF;">        ten_seconds = 10 / 60 / 60 / 24; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 341</span> <span style="color: #000000; background: #FFFFFF;">        if remaining_time &gt; ten_seconds </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 342</span> <span style="color: #000000; background: #FFFFFF;">            total_blocks = num_blocks + previously_processed; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 343</span> <span style="color: #000000; background: #FFFFFF;">            if <a href="file82.html">usejava</a>('awt') </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 344</span> <span style="color: #000000; background: #FFFFFF;">                wait_bar = iptui.cancellableWaitbar('Block Processing:',... </span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #000000; background: #FFFFFF;">                    'Processing %d blocks',total_blocks,previously_processed + k);</span><br/>               <span style="color: #A0A0A0"> 346</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 347</span> <span style="color: #A0A0A0; background: #FFFFFF;">                wait_bar = iptui.textWaitUpdater('Block Processing %d blocks.',...</span><br/>               <span style="color: #A0A0A0"> 348</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Completed %d of %d blocks.',total_blocks);</span><br/>               <span style="color: #A0A0A0"> 349</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 350</span> <span style="color: #000000; background: #FFFFFF;">            cleanup_waitbar = onCleanup(@() destroy(wait_bar)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 351</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 352</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/><span style="color: #FF0000">  1.79 </span><span style="color: #0000FF">  40060 </span><span style="color: #000000; font-weight: bold"> 353</span> <span style="color: #000000; background: #FFFFFF;">    elseif wait_bar.isCancelled() </span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #228B22; background: #FFFFFF;">        % we had a waitbar, but the user hit the cancel button</span><br/>               <span style="color: #A0A0A0"> 355</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 356</span> <span style="color: #228B22; background: #FFFFFF;">        % clear onCleanup objects to close file handles</span><br/>               <span style="color: #A0A0A0"> 357</span> <span style="color: #A0A0A0; background: #FFFFFF;">        clear cleanup_a cleanup_b;</span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #228B22; background: #FFFFFF;">        % delete the output file if necessary</span><br/>               <span style="color: #A0A0A0"> 359</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if destination_specified &amp;&amp; isequal(exist(dest_file_name,'file'),2)</span><br/>               <span style="color: #A0A0A0"> 360</span> <span style="color: #A0A0A0; background: #FFFFFF;">            delete(dest_file_name);</span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 362</span> <span style="color: #228B22; background: #FFFFFF;">        % reset output adapter to be empty (if nargout &gt; 0)</span><br/>               <span style="color: #A0A0A0"> 363</span> <span style="color: #A0A0A0; background: #FFFFFF;">        b = internal.images.MatrixAdapter([]);</span><br/>               <span style="color: #A0A0A0"> 364</span> <span style="color: #A0A0A0; background: #FFFFFF;">        break</span><br/>               <span style="color: #A0A0A0"> 365</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  40060 </span><span style="color: #000000; font-weight: bold"> 366</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>               <span style="color: #A0A0A0"> 367</span> <span style="color: #228B22; background: #FFFFFF;">        % we have a waitbar and it has not been canceled</span><br/><span style="color: #FF0000"> 28.27 </span><span style="color: #0000FF">  40060 </span><span style="color: #000000; font-weight: bold"> 368</span> <a name="Line368"></a><span style="color: #000000; background: #FFFFFF;">        wait_bar.update(); </span><br/>               <span style="color: #A0A0A0"> 369</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  40060 </span><span style="color: #000000; font-weight: bold"> 370</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  40061 </span><span style="color: #000000; font-weight: bold"> 372</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 373</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #228B22; background: #FFFFFF;">% clean up wait bar if we made one</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 375</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(wait_bar) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 376</span> <span style="color: #000000; background: #FFFFFF;">    clear cleanup_waitbar; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 377</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 379</span> <span style="color: #000000; background: #FFFFFF;">if ~destination_specified </span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #228B22; background: #FFFFFF;">    % return entire matrix when 'Destination' is not specified</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 381</span> <span style="color: #000000; background: #FFFFFF;">    result_size = b.ImageSize; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 382</span> <span style="color: #000000; background: #FFFFFF;">    result_image = b.readRegion([1 1],result_size(1:2)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 383</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 385</span> <span style="color: #000000; background: #FFFFFF;">end % blockproc </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>